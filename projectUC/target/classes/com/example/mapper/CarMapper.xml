<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.example.mapper.CarMapper">

	<select id="getList" resultType="com.example.domain.CarVO">
	<![CDATA[
		select * from uc_car
	]]>
	</select>
	
	<insert id="insert">
	
		<selectKey resultType="int" keyProperty="num" order="AFTER">
  		
  			SELECT MAX(num) FROM uc_car
  		
  		</selectKey> 			
		insert into
			uc_car (cop_name, br_name, car_name, price, mileage, model_year, fuel_type, color, region, number_p, seller, num, uc_text, owner)
		values
			(#{cop_name}, #{br_name}, #{car_name}, #{price}, #{mileage}, #{model_year}, #{fuel_type}, #{color}, #{region}, #{number_p}, #{seller}, SEQ_NUM.nextval, #{uc_text}, #{owner})
	    </insert>
	
	<!-- 이미지 등록 -->
	<insert id="imageEnroll">
	
		insert into uc_image(num, fileName, uploadPath, uuid) values (#{num}, #{fileName}, #{uploadPath}, #{uuid})
	
	</insert>

	<!-- 상품 리스트 -->
  	<select id="goodsGetList" resultType="com.example.domain.CarVO">  		  
					
		select * from uc_car
				  		
<!-- 		    <if test="keyword != null"> -->
		    
<!-- 			    cop_name like '%' || #{keyword} || '%' or -->
<!-- 			    br_name like '%' || #{keyword} || '%' or -->
<!-- 			    car_name like '%' || #{keyword} || '%' 	    -->
			    
<!-- 		    </if> -->
		     
<!-- 		<![CDATA[     -->
<!-- 		    rownum <= #{pageNum} * #{amount}  -->
<!-- 		    ) -->
<!-- 		where rn > (#{pageNum} -1) * #{amount}		  	 -->
<!--   		]]> -->
  	
  	</select>
  	
  	<!-- 상품 정보 -->
	<select id="getGoodsInfo" resultType="com.example.domain.CarVO">
	select 
		cop_name, br_name, car_name, price, mileage, model_year, fuel_type, color,
		region, number_p, owner, uc_text, seller,
		to_char(regdate, 'yyyy/mm/dd') as regdate1,
		to_char(updatedate, 'yyyy/mm/dd') as updatedate1
   		from uc_car 
   		where num = ${num}
	
	</select>
  	
  	<!-- 상품 총 개수 -->
  	<select id="goodsGetTotal" resultType="int">
  	
  		select count(*) from uc_car
  		
  		<if test="keyword != null">
  		
  			where num like '%' || #{keyword} || '%'
  		</if>
  		
  	</select> 



	
	<!-- 아이디 중복검사 -->
  	<select id="idCheck" resultType="int">
  	
  		select count(*) from uc_member where id = #{id}
  	
  	</select>
	

</mapper>